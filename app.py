import customtkinter as ctk  # استيراد مكتبة واجهة المستخدم المخصصة
from gui import YouTubeDownloaderApp  # استيراد فئة التطبيق الرئيسية من وحدة gui
import os  # استيراد مكتبة التعامل مع نظام الملفات

def check_required_directories():
    """
    التأكد من وجود المجلدات المطلوبة للتطبيق وإنشائها إذا لم تكن موجودة
    
    هذه الدالة تتحقق من وجود مجلد اللغات الذي يحتوي على ملفات الترجمة،
    وتقوم بإنشائه إذا لم يكن موجوداً لتجنب أخطاء عند تشغيل التطبيق
    """
    # التأكد من وجود مجلد اللغات (languages) الذي يحتوي على ملفات ترجمة واجهة المستخدم
    if not os.path.exists("languages"):
        os.makedirs("languages")  # إنشاء المجلد إذا لم يكن موجوداً

def main():
    """
    الدالة الرئيسية للتطبيق التي تقوم بتهيئة النافذة الرئيسية وبدء تشغيل التطبيق
    
    تقوم بما يلي:
    1. التحقق من المجلدات المطلوبة
    2. إعداد مظهر التطبيق
    3. إنشاء النافذة الرئيسية وضبط خصائصها
    4. تشغيل حلقة أحداث التطبيق
    """
    # التحقق من وجود المجلدات المطلوبة للتطبيق
    check_required_directories()
    
    # إعداد المظهر الافتراضي للتطبيق وسمة الألوان
    ctk.set_appearance_mode("System")  # استخدام مظهر النظام (فاتح أو داكن حسب إعدادات النظام)
    ctk.set_default_color_theme("blue")  # تعيين سمة اللون الأزرق للتطبيق
    
    # إنشاء النافذة الرئيسية للتطبيق
    app = ctk.CTk()  # إنشاء كائن الإطار الرئيسي
    
    # تحديد أبعاد النافذة الافتراضية
    width = 800  # عرض النافذة بالبكسل
    height = 400  # ارتفاع النافذة بالبكسل

    # الحصول على أبعاد الشاشة لوضع النافذة في المنتصف
    screen_width = app.winfo_screenwidth()  # عرض الشاشة
    screen_height = app.winfo_screenheight()  # ارتفاع الشاشة

    # حساب الإحداثيات لوضع النافذة في منتصف الشاشة
    x = int((screen_width / 2) - (width / 2))  # الإحداثي السيني (المسافة من اليسار)
    y = int((screen_height / 2) - (height / 2))  # الإحداثي الصادي (المسافة من الأعلى)

    # تعيين حجم النافذة وموقعها على الشاشة باستخدام الصيغة: "العرض×الارتفاع+س+ص"
    app.geometry(f"{width}x{height}+{x}+{y}")
    
    # تعيين الحد الأدنى لحجم النافذة لضمان ظهور جميع عناصر الواجهة بشكل صحيح
    app.minsize(630, 350)  # أقل عرض: 630 بكسل، أقل ارتفاع: 350 بكسل
    
    # تعيين عنوان النافذة الذي يظهر في شريط العنوان
    app.title("Media Downloader")
    
    # إنشاء كائن من فئة التطبيق الرئيسية مع تمرير:
    # 1. النافذة الرئيسية (app) كإطار أساسي للتطبيق
    # 2. "en" كرمز اللغة الافتراضية (الإنجليزية)
    YouTubeDownloaderApp(app, "en")
    
    # بدء حلقة أحداث التطبيق الرئيسية (تستمر حتى إغلاق النافذة)
    app.mainloop()

# التحقق مما إذا كان هذا الملف يتم تشغيله مباشرة (وليس استيراده كوحدة)
if __name__ == "__main__":
    main()  # استدعاء الدالة الرئيسية لبدء التطبيق